function setupUI(){var e=jQuery("#navigation-toggle-link");e.click(toggleDrawer);setupScrollToContent();setupLightbox();jQuery("#image-navigation a").each(function(){var e=jQuery(this).attr("href")+"#content-body";jQuery(this).attr("href",e)});setupSharing()}function setupSharing(){$sharingLinks=jQuery(".sharing-list a:not(.pinterest):not(.email)");$sharingLinks.click(function(e){href=this.getAttribute("href");openWindow(href,"Share");e.preventDefault()});var e=jQuery(".sharing-list a.pinterest");e.click(function(e){faLoadingIndicator(jQuery(this),"fa-pinterest",2e3);pinterestPinIt();e.preventDefault()})}function setupParallax(){$siteHeader=jQuery("#site-header");$headerOverlay=jQuery("#page-header-overlay");var e=$siteHeader.not(".no-image").height();var t=0;if(e){jQuery(window).scroll(function(){if(window.context=="full"){if(window.pageTop<e){t=Math.abs(window.pageTop/2)*-1;$siteHeader.css("background-position","center "+t+"px");titleBottomOffset=(e-window.pageTop)/4;titleMinBottomOffset=80;opacity=titleBottomOffset/e*4+.2;opacity=opacity>1?1:opacity;$headerOverlay.css("bottom",titleBottomOffset+"px").css("opacity",opacity)}}});jQuery(window).resize(function(){e=$siteHeader.not(".no-image").height();if(window.context=="mobile"){$siteHeader.css("background-position","center 0");$headerOverlay.css("bottom","25%").css("opacity",1)}})}}function setupScrollToContent(){jQuery("#content-link").click(function(){var e=jQuery(this).attr("href");var t=jQuery(e).offset().top;jQuery("body,html").animate({scrollTop:t},700);return false})}function setupMasonry(){if(jQuery().masonry){jQuery("#resources_holder").masonry({itemSelector:".resource_holder"})}}function setupReadline(){jQuery(".readline").each(function(){var e=false;var t=jQuery(this);var n=jQuery(this).closest("article");var r=n.offset().top;var i=r+n.outerHeight();jQuery(window).resize(function(){r=n.offset().top;i=r+n.outerHeight()});var s=400;setInterval(function(){var e=window.pageTop;if(e>=r&&e<=i){var n=Math.round((e-r)/(i-r-s)*100);t.width(n+"%")}else{t.width(0)}},50)})}function setupLightbox(){jQuery(".gallery").each(function(e){var t=jQuery(this);var n=t.attr("id");var r=t.find(".gallery-icon a").filter("[href$='.jpg'], [href$='.gif'], [href$='.png']");r.each(function(){if(jQuery(this).attr("title")!=""){$link=jQuery(this);var e=$link.find("img").attr("alt");$link.attr("title",e)}});r.attr("data-lightbox-gallery",n);r.nivoLightbox({effect:"fadeScale"})})}function toggleDrawer(e){var t=jQuery("#control");var n=jQuery("#page");if(t.hasClass("open")){t.removeClass("open");n.unbind("click",toggleDrawer)}else{t.addClass("open");setTimeout(function(){n.bind("click",toggleDrawer)},500)}if(e){e.preventDefault()}}function setupSizeContext(){setSizeContext();var e;jQuery(window).resize(function(){e=setTimeout(setSizeContext,200)})}function setSizeContext(){$body=jQuery("body");$body.removeClass(window.context);var e=jQuery(window).width();window.context=e>640?"full":"mobile";jQuery("body").addClass(window.context)}function openWindow(e,t){var n=700;var r=450;var i=screen.width/2-n/2;var s=screen.height/2-r/2;window.open(e,t,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, height="+r+", width="+n+", left="+i+", top="+s)}function pinterestPinIt(){var e=document.createElement("script");e.setAttribute("type","text/javascript");e.setAttribute("charset","UTF-8");e.setAttribute("src","http://assets.pinterest.com/js/pinmarklet.js?r="+Math.random()*99999999);document.body.appendChild(e)}function faLoadingIndicator(e,t,n){$icon=e.find(".fa");$icon.removeClass(t);$icon.addClass("fa-spinner").addClass("fa-spin");setTimeout(function(){$icon.removeClass("fa-spinner").removeClass("fa-spin");$icon.addClass(t)},n)}window.context;jQuery(function(){setupUI();setupSizeContext()});jQuery(window).load(function(){window.pageTop=0;$window=jQuery(window);jQuery(window).scroll(function(){window.pageTop=$window.scrollTop()});setupParallax();setupMasonry();setupReadline()})