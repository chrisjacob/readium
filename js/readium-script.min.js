function setupUI(){var e=jQuery("#navigation-toggle-link");e.click(toggleDrawer),setupScrollToContent(),setupLightbox(),setupSharing()}function setupSharing(){$sharingLinks=jQuery(".sharing-list a:not(.pinterest):not(.email)"),$sharingLinks.click(function(e){href=this.getAttribute("href"),openWindow(href,"Share"),e.preventDefault()});var e=jQuery(".sharing-list a.pinterest");e.click(function(e){faLoadingIndicator(jQuery(this),"fa-pinterest",2e3),pinterestPinIt(),e.preventDefault()})}function setupParallax(){$siteHeader=jQuery("#site-header"),$headerOverlay=jQuery("#page-header-overlay");var e=$siteHeader.not(".no-image").height(),t=0;e&&(jQuery(window).scroll(function(){"full"==window.context&&window.pageTop<e&&(t=-1*Math.abs(window.pageTop/2),$siteHeader.css("background-position","center "+t+"px"),titleBottomOffset=(e-window.pageTop)/4,titleMinBottomOffset=80,opacity=titleBottomOffset/e*4+.2,opacity=opacity>1?1:opacity,$headerOverlay.css("bottom",titleBottomOffset+"px").css("opacity",opacity))}),jQuery(window).resize(function(){e=$siteHeader.not(".no-image").height(),"mobile"==window.context&&($siteHeader.css("background-position","center 0"),$headerOverlay.css("bottom","25%").css("opacity",1))}))}function setupScrollToContent(){jQuery("#content-link").click(function(){var e=jQuery(this).attr("href"),t=jQuery(e).offset().top;return jQuery("body,html").animate({scrollTop:t},700),!1})}function setupReadline(){jQuery(".readline").each(function(){var e=jQuery(this),t=jQuery(this).closest("article"),n=t.offset().top,o=n+t.outerHeight();jQuery(window).resize(function(){n=t.offset().top,o=n+t.outerHeight()});var i=400;setInterval(function(){var t=window.pageTop;if(t>=n&&o>=t){var r=Math.round((t-n)/(o-n-i)*100);e.width(r+"%")}else e.width(0)},50)})}function setupLightbox(){jQuery(".gallery").each(function(){var e=jQuery(this),t=e.attr("id"),n=e.find(".gallery-icon a").filter("[href$='.jpg'], [href$='.gif'], [href$='.png']");n.each(function(){if(""!=jQuery(this).attr("title")){$link=jQuery(this);var e=$link.find("img").attr("alt");$link.attr("title",e)}}),n.attr("data-lightbox-gallery",t),n.nivoLightbox({effect:"fadeScale"})})}function toggleDrawer(e){var t=jQuery("#control"),n=jQuery("#page");t.hasClass("open")?(t.removeClass("open"),n.unbind("click",toggleDrawer)):(t.addClass("open"),setTimeout(function(){n.bind("blick",toggleDrawer)},500)),e&&e.preventDefault()}function setupSizeContext(){setSizeContext();var e;jQuery(window).resize(function(){e=setTimeout(setSizeContext,200)})}function setSizeContext(){$body=jQuery("body"),$body.removeClass(window.context);var e=jQuery(window).width();window.context=e>640?"full":"mobile",jQuery("body").addClass(window.context)}function openWindow(e,t){var n=700,o=450,i=screen.width/2-n/2,r=screen.height/2-o/2;window.open(e,t,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, height="+o+", width="+n+", left="+i+", top="+r)}function pinterestPinIt(){var e=document.createElement("script");e.setAttribute("type","text/javascript"),e.setAttribute("charset","UTF-8"),e.setAttribute("src","http://assets.pinterest.com/js/pinmarklet.js?r="+99999999*Math.random()),document.body.appendChild(e)}function faLoadingIndicator(e,t,n){$icon=e.find(".fa"),$icon.removeClass(t),$icon.addClass("fa-spinner").addClass("fa-spin"),setTimeout(function(){$icon.removeClass("fa-spinner").removeClass("fa-spin"),$icon.addClass(t)},n)}window.context,jQuery(function(){setupUI(),setupSizeContext()}),jQuery(window).load(function(){window.pageTop=0,$window=jQuery(window),jQuery(window).scroll(function(){window.pageTop=$window.scrollTop()}),setupParallax(),setupReadline()});